return function(Window)
    local PlayerTab = Window:CreateTab("Player", "users")

    PlayerTab:CreateSection("Movement")

    PlayerTab:CreateSection("Anti Kick for Idle")

PlayerTab:CreateToggle({
    Name = "Anti-AFK",
    CurrentValue = false,
    Flag = "AntiAFK",
    Callback = function(Value)
        if getgenv().AntiAFKConnection then
            getgenv().AntiAFKConnection:Disconnect()
            getgenv().AntiAFKConnection = nil
        end

        if Value then
            getgenv().AntiAFKConnection = game:GetService("Players").LocalPlayer.Idled:Connect(function()
                game:GetService("VirtualUser"):CaptureController()
                game:GetService("VirtualUser"):ClickButton2(Vector2.new())
            end)

            Rayfield:Notify({
                Title = "Anti-AFK: ON",
                Content = "You won't be kicked for idling",
                Duration = 3,
                Image = 6023426915
            })
        else
            Rayfield:Notify({
                Title = "Anti-AFK: OFF",
                Content = "Normal AFK rules apply",
                Duration = 3,
                Image = 6022668888
            })
        end
    end,
})

game:GetService("Players").LocalPlayer.CharacterAdded:Connect(function()
    if getgenv().AntiAFKConnection then
        getgenv().AntiAFKConnection:Disconnect()
    end
    if Tab.Flags and Tab.Flags["AntiAFK"] then
        getgenv().AntiAFKConnection = game:GetService("Players").LocalPlayer.Idled:Connect(function()
            game:GetService("VirtualUser"):CaptureController()
            game:GetService("VirtualUser"):ClickButton2(Vector2.new())
        end)
    end
end)
